# Acceder a tu token
token_aqicn = open(r"C:\Users\juang\Documents\FCFM\2do Semestre\Programacion Basica\PIA\token_aqicn.txt", "r")
token = token_aqicn.read().strip()  # strip() para quitar saltos de lÃ­nea si los hay
token_aqicn.close()

# Importar librerÃ­as
import requests
import pandas as pd
import json

# Hacer la peticiÃ³n
url = f"https://api.waqi.info/feed/here/?token={token}"
respuesta = requests.get(url)
data = respuesta.json()

# Guardar la respuesta en un archivo
with open(r"C:\Users\juang\Documents\FCFM\2do Semestre\Programacion Basica\PIA\busqueda_prueba.txt", "w") as busqueda:
    json.dump(data, busqueda, indent=4, ensure_ascii=False)

# Datos generales
print(f"ğŸ“ Ciudad: {data['data']['city']['name']}")
print(f"ğŸ—“ï¸ Fecha: {data['data']['time']['iso']}")
print(f"ğŸŒ«ï¸ AQI actual (pm2.5): {data['data']['aqi']}")
print(f"â˜ï¸ Contaminante dominante: {data['data']['dominentpol']}")

# Datos de contaminantes actuales
print("\nğŸ“Š Contaminantes actuales:")
for contaminante, valor in data['data']['iaqi'].items():
    print(f"  {contaminante.upper()}: {valor['v']}")

# PronÃ³stico de PM2.5
print("\nğŸ”® PronÃ³stico PM2.5 para los prÃ³ximos dÃ­as:")
for dia in data['data']['forecast']['daily']['pm25']:
    print(f"  {dia['day']}: promedio {dia['avg']}, mÃ¡x {dia['max']}, mÃ­n {dia['min']}")
